(()=>{"use strict";const e=()=>{let e=!1;const t=[],a=[];return{placeShip:(e,t,s,r)=>{const n=((e,t,a,s)=>{let r=t,n=a;const o=[];for(let t=0;t<e;t+=1){let e=`${r},${n}`;o.push(e),"vertical"===s?e=`${r},${n+=1}`:"horizontal"===s&&(e=`${r+=1},${n}`)}let l=0;return{length:e,shipsCoordinatesArray:o,hits:l,hit:()=>(l+=1,l),position:s,isSunk:(e,t)=>e<=t,sunkStatus:!1}})(e,t,s,r);return a.push(n),a},receiveAttack:(e,s)=>{let r=!1,n="";const o=`${e},${s}`;return t.includes(o)?"Please enter coordinates not previously attacked!":(a.forEach((e=>{e.shipsCoordinatesArray.forEach((t=>!0===r?n:o!==t?(n="attack missed",n):(r=!0,e.hits=e.hit(),e.sunkStatus=e.isSunk(e.length,e.hits),n="ship has been hit!",n)))})),t.push(o),n)},shipArray:a,SquaresHit:t,determineIfConcluded:()=>{let t=0;return a.forEach((e=>{!0===e.sunkStatus&&(t+=1)})),t!==a.length||(e=!0),e},areAllShipsSunk:e}},t=(e,t)=>({playername:e,turn:t});(()=>{const e=document.querySelector(".playerboard"),t=document.createElement("div");t.classList.add("playerboard"),e.appendChild(t);for(let e=9;e>=-1;e-=1){const a=document.createElement("div");if(a.classList.add("row"),-1===e)for(let e=-1;e<10;e+=1)if(-1===e){const e=document.createElement("div");e.classList.add("squarelabel"),a.appendChild(e)}else{const t=document.createElement("div");t.classList.add("squarelabel"),t.textContent=`${e}`,a.appendChild(t)}else for(let t=-1;t<10;t+=1)if(-1===t){const t=document.createElement("div");t.classList.add("squarelabel"),t.textContent=`${e}`,a.appendChild(t)}else{const s=document.createElement("div");s.classList.add("playersquare"),s.setAttribute("id",`${t},${e}`),a.appendChild(s)}t.appendChild(a)}})(),t("Player 1",!0);const a=e();(()=>{const e=document.querySelector(".computerboard"),t=document.createElement("div");t.classList.add("playerboard"),e.appendChild(t);for(let e=9;e>=-1;e-=1){const a=document.createElement("div");if(a.classList.add("row"),-1===e)for(let e=-1;e<10;e+=1)if(-1===e){const e=document.createElement("div");e.classList.add("squarelabel"),a.appendChild(e)}else{const t=document.createElement("div");t.classList.add("squarelabel"),t.textContent=`${e}`,a.appendChild(t)}else for(let t=-1;t<10;t+=1)if(-1===t){const t=document.createElement("div");t.classList.add("squarelabel"),t.textContent=`${e}`,a.appendChild(t)}else{const s=document.createElement("div");s.classList.add("square"),s.setAttribute("id",`${t},${e}`),a.appendChild(s)}t.appendChild(a)}})();const s=e();t("Computer",!1);for(let e=1;e<7;e+=1){const t=Math.floor(Math.random()*(10-e)),a=Math.floor(Math.random()*(10-e)),r=Math.floor(2*Math.random());let n;1===r?n="vertical":0===r&&(n="horizontal"),s.placeShip(e,t,a,n)}console.log(s.shipArray),(()=>{document.querySelectorAll(".ship").forEach((e=>{e.addEventListener("dragstart",(e=>{e.dataTransfer.setData("shipgrabbed",e.target.id);const t=e.target.childElementCount;e.dataTransfer.setData("stringlen",t),e.dataTransfer.setData("xoff",e.offsetX),e.dataTransfer.setData("yoff",e.offsetY),e.target.classList.contains("vertical")?e.dataTransfer.setData("pos","vertical"):e.target.classList.contains("horizontal")&&e.dataTransfer.setData("pos","horizontal")}))}));const e=document.querySelectorAll(".playersquare");e.forEach((t=>{t.addEventListener("dragover",(e=>{e.preventDefault()})),t.addEventListener("drop",(t=>{t.preventDefault();const s=t.dataTransfer.getData("stringlen"),r=t.dataTransfer.getData("xoff"),n=t.dataTransfer.getData("yoff"),o=t.dataTransfer.getData("pos"),l=parseInt(s,10);let d=0,i=0;"vertical"===o?(d=0,i=l-Math.ceil(n/34)):"horizontal"===o&&(d=Math.floor(r/34),i=0);const c=t.target.id.split(","),h=parseInt(c[0],10)-d,p=parseInt(c[1],10)-i;if(console.log(`Final coords to create object are: ${h}, ${p}`),"vertical"===o&&p+l>10||"vertical"===o&&p<0)console.log("y above 10 or below 0");else if("horizontal"===o&&h+l>10||"horizontal"===o&&h<0)console.log("x above 10 or below 0");else{a.placeShip(l,h,p,o),console.log(a.shipArray),document.getElementById(t.dataTransfer.getData("shipgrabbed")).style.visibility="hidden";const s=a.shipArray.length-1,r=a.shipArray[s];e.forEach((e=>{for(let t=0;t<r.shipsCoordinatesArray.length;t+=1)e.id===r.shipsCoordinatesArray[t]&&e.classList.add("blue")}))}}))}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVFxRSxJQUNqQixJQUFLLElBQUlwRixFQUFJLEVBQUdBLEVBQUltRixFQUFTcEYsc0JBQXNCUCxPQUFRUSxHQUFLLEVBQzFEb0YsRUFBTTNCLEtBQU8wQixFQUFTcEYsc0JBQXNCQyxJQUM5Q29GLEVBQU14RCxVQUFVQyxJQUFJLE9BRXhCLEdBRUosSUFDRCxHQUNGLEVBSUh3RCxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9wcm9qZWN0LmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZGVzaWduLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IChsZW5ndGgsIHhjb29yZCwgeWNvb3JkLCBwb3NpdGlvbikgPT4ge1xuICBsZXQgdGVtcHggPSB4Y29vcmQ7XG4gIGxldCB0ZW1weSA9IHljb29yZDtcblxuICBjb25zdCBzaGlwc0Nvb3JkaW5hdGVzQXJyYXkgPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgIGxldCBzaGlwQ29vcmRpbmF0ZXMgPSBgJHt0ZW1weH0sJHt0ZW1weX1gO1xuICAgIHNoaXBzQ29vcmRpbmF0ZXNBcnJheS5wdXNoKHNoaXBDb29yZGluYXRlcyk7XG5cbiAgICBpZiAocG9zaXRpb24gPT09IFwidmVydGljYWxcIikge1xuICAgICAgc2hpcENvb3JkaW5hdGVzID0gYCR7dGVtcHh9LCR7KHRlbXB5ICs9IDEpfWA7XG4gICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgIHNoaXBDb29yZGluYXRlcyA9IGAkeyh0ZW1weCArPSAxKX0sJHt0ZW1weX1gO1xuICAgIH1cbiAgfVxuXG4gIGxldCBoaXRzID0gMDtcbiAgY29uc3QgaGl0ID0gKCkgPT4ge1xuICAgIGhpdHMgKz0gMTtcbiAgICAvLyBjb25zb2xlLmxvZyhoaXRzKTtcbiAgICByZXR1cm4gaGl0cztcbiAgfTtcblxuICBjb25zdCBzdW5rU3RhdHVzID0gZmFsc2U7XG4gIGNvbnN0IGlzU3VuayA9IChsZW5ndGhPZlNoaXAsIGhpdHNPZlNoaXApID0+IHtcbiAgICBpZiAobGVuZ3RoT2ZTaGlwIDw9IGhpdHNPZlNoaXApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBsZW5ndGgsXG4gICAgc2hpcHNDb29yZGluYXRlc0FycmF5LFxuICAgIGhpdHMsXG4gICAgaGl0LFxuICAgIHBvc2l0aW9uLFxuICAgIGlzU3VuayxcbiAgICBzdW5rU3RhdHVzLFxuICB9O1xufTtcblxuY29uc3QgR2FtZWJvYXJkID0gKCkgPT4ge1xuICBsZXQgYXJlQWxsU2hpcHNTdW5rID0gZmFsc2U7XG4gIGNvbnN0IFNxdWFyZXNIaXQgPSBbXTtcbiAgY29uc3Qgc2hpcEFycmF5ID0gW107XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gKGxlbmd0aCwgeGNvb3JkLCB5Y29vcmQsIHBvc2l0aW9uKSA9PiB7XG4gICAgXG4gICAgICAvLyBTT01FSFdFUkUgSEVSRSBBREQgVkFMSURBVElPTiA9IEdPSU5HIFRIUk9VR0ggQUxMIFRIRSBDT09SRFMgT0YgVEhFIFBSRVZJT1VTIFNISVBTIEFORCBDSEVDS0lORyBUSEVZIERPTlQgRVFVQUwgRUFDSCBPVEhFUi5cbiAgICAgIGNvbnN0IG5ld1NoaXAgPSBTaGlwKGxlbmd0aCwgeGNvb3JkLCB5Y29vcmQsIHBvc2l0aW9uKTtcbiAgICAgIHNoaXBBcnJheS5wdXNoKG5ld1NoaXApO1xuICAgICAgcmV0dXJuIHNoaXBBcnJheTtcbiAgXG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9ICh4Y29vcmQsIHljb29yZCkgPT4ge1xuICAgIGxldCB3YXNIaXQgPSBmYWxzZTtcbiAgICBsZXQgbWVzc2FnZSA9IFwiXCI7XG4gICAgY29uc3QgY29vcmRpbmF0ZXMgPSBgJHt4Y29vcmR9LCR7eWNvb3JkfWA7XG4gICAgaWYgKFNxdWFyZXNIaXQuaW5jbHVkZXMoY29vcmRpbmF0ZXMpKSB7XG4gICAgICByZXR1cm4gXCJQbGVhc2UgZW50ZXIgY29vcmRpbmF0ZXMgbm90IHByZXZpb3VzbHkgYXR0YWNrZWQhXCI7XG4gICAgfVxuICAgIHNoaXBBcnJheS5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBzaGlwLnNoaXBzQ29vcmRpbmF0ZXNBcnJheS5mb3JFYWNoKChzZWxlY3RlZFNoaXBDb29yZGluYXRlcykgPT4ge1xuICAgICAgICBpZiAod2FzSGl0ID09PSB0cnVlKSB7XG4gICAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29vcmRpbmF0ZXMgPT09IHNlbGVjdGVkU2hpcENvb3JkaW5hdGVzKSB7XG4gICAgICAgICAgLy9cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtZXNzYWdlID0gXCJhdHRhY2sgbWlzc2VkXCI7XG4gICAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgd2FzSGl0ID0gdHJ1ZTtcbiAgICAgICAgc2hpcC5oaXRzID0gc2hpcC5oaXQoKTtcbiAgICAgICAgc2hpcC5zdW5rU3RhdHVzID0gc2hpcC5pc1N1bmsoc2hpcC5sZW5ndGgsIHNoaXAuaGl0cyk7XG4gICAgICAgIG1lc3NhZ2UgPSBcInNoaXAgaGFzIGJlZW4gaGl0IVwiO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIFNxdWFyZXNIaXQucHVzaChjb29yZGluYXRlcyk7XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH07XG5cbiAgY29uc3QgZGV0ZXJtaW5lSWZDb25jbHVkZWQgPSAoKSA9PiB7XG4gICAgbGV0IHN1bmtlblNoaXBzID0gMDtcbiAgICBzaGlwQXJyYXkuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgaWYgKHNoaXAuc3Vua1N0YXR1cyA9PT0gdHJ1ZSkge1xuICAgICAgICBzdW5rZW5TaGlwcyArPSAxO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHN1bmtlblNoaXBzID09PSBzaGlwQXJyYXkubGVuZ3RoKSB7XG4gICAgICBhcmVBbGxTaGlwc1N1bmsgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYXJlQWxsU2hpcHNTdW5rO1xuICAgIH1cbiAgICByZXR1cm4gYXJlQWxsU2hpcHNTdW5rO1xuICB9O1xuXG4gIC8vIGNvbnN0IGdhbWVib2FyZCA9IFtdO1xuICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpICs9IDEpIHtcbiAgLy8gICBsZXQgcm93ID0gW107XG4gIC8vICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaiArPSAxKSB7XG4gIC8vICAgICBjb25zdCB0ZW1wID0gW2ksIGpdO1xuICAvLyAgICAgcm93LnB1c2godGVtcCk7XG4gIC8vICAgfVxuICAvLyAgIGdhbWVib2FyZC5wdXNoKHJvdyk7XG4gIC8vICAgcm93ID0gW107XG4gIC8vIH1cblxuICByZXR1cm4ge1xuICAgIHBsYWNlU2hpcCxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIHNoaXBBcnJheSxcbiAgICBTcXVhcmVzSGl0LFxuICAgIGRldGVybWluZUlmQ29uY2x1ZGVkLFxuICAgIGFyZUFsbFNoaXBzU3VuayxcbiAgfTtcbn07XG5cblxuY29uc3QgUGxheWVyID0gKHBsYXllcm5hbWUsIHR1cm4pID0+IFxuICAvLyB0aGlzLnBsYXllcm5hbWUgPSBwbGF5ZXJuYW1lO1xuICAvLyB0aGlzLnR1cm4gPSB0dXJuO1xuICAgKHsgcGxheWVybmFtZSwgdHVybiB9KVxuO1xuXG5leHBvcnQgeyBTaGlwLCBHYW1lYm9hcmQsIFBsYXllciB9OyIsIlxuXG5jb25zdCBnZXRQbGF5ZXJOYW1lID0gKCkgPT4ge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3ZlcmxheVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIGNvbnN0IG5hbWVidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1uYW1lXCIpO1xuICAgIG5hbWVidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGNvbnN0IG5hbWVpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZVwiKTtcbiAgICAgIGNvbnN0IGRvbXBsYXllcm5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllcm5hbWVcIik7XG5cbiAgICAgIGlmIChuYW1laW5wdXQudmFsdWUgPT09IFwiXCIpIHtcbiAgICAgICAgbmFtZWlucHV0LnZhbHVlID0gXCJQbGF5ZXIgMVwiO1xuICAgICAgfVxuXG4gICAgICBkb21wbGF5ZXJuYW1lLnRleHRDb250ZW50ID0gbmFtZWlucHV0LnZhbHVlO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvdmVybGF5XCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgIHJldHVybiBuYW1laW5wdXQudmFsdWU7XG4gICAgfSlcbn1cblxuY29uc3QgZ2VuZXJhdGVQbGF5ZXJCb2FyZCA9ICgpID0+IHtcbiAgY29uc3QgcGxheWVyYm9hcmRkaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllcmJvYXJkXCIpO1xuICBjb25zdCBwbGF5ZXJCb2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIHBsYXllckJvYXJkLmNsYXNzTGlzdC5hZGQoXCJwbGF5ZXJib2FyZFwiKTtcbiAgcGxheWVyYm9hcmRkaXYuYXBwZW5kQ2hpbGQocGxheWVyQm9hcmQpO1xuXG4gIGZvciAobGV0IGkgPSA5OyBpID49IC0xOyBpIC09IDEpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHJvdy5jbGFzc0xpc3QuYWRkKFwicm93XCIpO1xuICAgIC8vIGZvclxuICAgIGlmICggaSA9PT0gLTEpIHtcbiAgICAgIGZvciAobGV0IGogPSAtMTsgaiA8IDEwOyBqICs9IDEpIHtcbiAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgY29uc3Qgc3F1YXJlbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgIHNxdWFyZWxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVsYWJlbFwiKTtcbiAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoc3F1YXJlbGFiZWwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IHNxdWFyZWxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICBzcXVhcmVsYWJlbC5jbGFzc0xpc3QuYWRkKFwic3F1YXJlbGFiZWxcIik7XG4gICAgICAgICAgc3F1YXJlbGFiZWwudGV4dENvbnRlbnQgPSBgJHtqfWBcbiAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoc3F1YXJlbGFiZWwpO1xuICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2UgeyBcbiAgICAgIGZvciAobGV0IGogPSAtMTsgaiA8IDEwOyBqICs9IDEpIHtcbiAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgY29uc3Qgc3F1YXJlbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgIHNxdWFyZWxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVsYWJlbFwiKTtcbiAgICAgICAgICBzcXVhcmVsYWJlbC50ZXh0Q29udGVudCA9IGAke2l9YFxuICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChzcXVhcmVsYWJlbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInBsYXllcnNxdWFyZVwiKTtcbiAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgYCR7an0sJHtpfWApXG4gICAgICAgICAgcm93LmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgICAgIH1cbiAgICAgIFxuICAgICAgfVxuICAgIH1cbiAgICAvL1xuICAgIHBsYXllckJvYXJkLmFwcGVuZENoaWxkKHJvdyk7XG4gIH1cbiAgXG59XG5cbmNvbnN0IGdlbmVyYXRlQ29tcHV0ZXJCb2FyZCA9ICgpID0+IHtcbiAgY29uc3QgY29tcHV0ZXJib2FyZGRpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcHV0ZXJib2FyZFwiKTtcbiAgY29uc3QgcGxheWVyQm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBwbGF5ZXJCb2FyZC5jbGFzc0xpc3QuYWRkKFwicGxheWVyYm9hcmRcIik7XG4gIGNvbXB1dGVyYm9hcmRkaXYuYXBwZW5kQ2hpbGQocGxheWVyQm9hcmQpO1xuXG4gIGZvciAobGV0IGkgPSA5OyBpID49IC0xOyBpIC09IDEpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHJvdy5jbGFzc0xpc3QuYWRkKFwicm93XCIpO1xuICAgIC8vIGZvclxuICAgIGlmICggaSA9PT0gLTEpIHtcbiAgICAgIGZvciAobGV0IGogPSAtMTsgaiA8IDEwOyBqICs9IDEpIHtcbiAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgY29uc3Qgc3F1YXJlbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgIHNxdWFyZWxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVsYWJlbFwiKTtcbiAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoc3F1YXJlbGFiZWwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IHNxdWFyZWxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICBzcXVhcmVsYWJlbC5jbGFzc0xpc3QuYWRkKFwic3F1YXJlbGFiZWxcIik7XG4gICAgICAgICAgc3F1YXJlbGFiZWwudGV4dENvbnRlbnQgPSBgJHtqfWBcbiAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoc3F1YXJlbGFiZWwpO1xuICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2UgeyBcbiAgICAgIGZvciAobGV0IGogPSAtMTsgaiA8IDEwOyBqICs9IDEpIHtcbiAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgY29uc3Qgc3F1YXJlbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgIHNxdWFyZWxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVsYWJlbFwiKTtcbiAgICAgICAgICBzcXVhcmVsYWJlbC50ZXh0Q29udGVudCA9IGAke2l9YFxuICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChzcXVhcmVsYWJlbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZVwiKTtcbiAgICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgYCR7an0sJHtpfWApXG4gICAgICAgICAgcm93LmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgICAgIH1cbiAgICAgIFxuICAgICAgfVxuICAgIH1cbiAgICAvL1xuICAgIHBsYXllckJvYXJkLmFwcGVuZENoaWxkKHJvdyk7XG4gIH1cbn1cblxuXG5cbmV4cG9ydCB7IGdldFBsYXllck5hbWUsIGdlbmVyYXRlUGxheWVyQm9hcmQsIGdlbmVyYXRlQ29tcHV0ZXJCb2FyZH07IFxuXG4gIC8vIGZvciAoY29uc3Qgc3F1YXJlZHJvcHpvbmUgb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zcXVhcmVcIikpIHtcbiAgLy8gICBzcXVhcmVkcm9wem9uZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgZSA9PiB7XG4gIC8vICAgICBjb25zb2xlLmxvZyhlKTtcbiAgLy8gICAgIGNvbnNvbGUubG9nKGUudGFyZ2V0KTtcbiAgLy8gICB9KVxuICAvLyB9IiwiaW1wb3J0IHsgR2FtZWJvYXJkLCBTaGlwLCBQbGF5ZXIgfSBmcm9tIFwiLi9wcm9qZWN0XCI7XG5pbXBvcnQgeyBnZXRQbGF5ZXJOYW1lLCBnZW5lcmF0ZVBsYXllckJvYXJkLCBnZW5lcmF0ZUNvbXB1dGVyQm9hcmQgfSBmcm9tIFwiLi9kZXNpZ25cIjtcblxuXG5cbi8vIEdhbWUgbG9vcCBiZWdpbnNcbi8vIEdldHMgdGhlIHBsYXllciBhbmQgY3JlYXRlcyBib3RoIGdhbWVib2FyZHMsIGFuZCBib3RoIG9iamVjdHMuXG5jb25zdCBwbGF5ZXJzbmFtZSA9IFwiUGxheWVyIDFcIjtcbi8vIHBsYXllcnNuYW1lID0gZ2V0UGxheWVyTmFtZSgpOyBcbmdlbmVyYXRlUGxheWVyQm9hcmQoKTtcbmNvbnN0IFBsYXllcjEgPSBQbGF5ZXIoYCR7cGxheWVyc25hbWV9YCwgdHJ1ZSk7XG5jb25zdCBQbGF5ZXJib2FyZCA9IEdhbWVib2FyZCgpO1xuXG5nZW5lcmF0ZUNvbXB1dGVyQm9hcmQoKTtcbmNvbnN0IENvbXB1dGVyYm9hcmQgPSBHYW1lYm9hcmQoKTtcbmNvbnN0IENvbXB1dGVyID0gUGxheWVyKFwiQ29tcHV0ZXJcIiwgZmFsc2UpO1xuXG4vLyBQbGFjaW5nIFNoaXBzXG5mb3IgKGxldCBpID0gMTsgaSA8IDc7IGkgKz0gMSkge1xuICBjb25zdCB0ZW1weGNvb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKDEwIC0gaSkpO1xuICBjb25zdCB0ZW1weWNvb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKDEwIC0gaSkpO1xuICBjb25zdCB0ZW1wcG9zID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMik7XG4gIGxldCB0ZW1wcG9zaXRpb247XG4gIFxuICBpZiAodGVtcHBvcyA9PT0gMSkge1xuICAgIHRlbXBwb3NpdGlvbiA9IFwidmVydGljYWxcIjtcbiAgfSBlbHNlIGlmICh0ZW1wcG9zID09PSAwKSB7XG4gICAgdGVtcHBvc2l0aW9uID0gXCJob3Jpem9udGFsXCI7XG4gIH1cblxuICBDb21wdXRlcmJvYXJkLnBsYWNlU2hpcChpLCB0ZW1weGNvb3JkLCB0ZW1weWNvb3JkLCB0ZW1wcG9zaXRpb24pO1xufVxuLy8gRklYIC0gU2hpcHMgb3ZlcmxhcCFcblxuY29uc29sZS5sb2coQ29tcHV0ZXJib2FyZC5zaGlwQXJyYXkpO1xuXG4vLyBjb25zb2xlLmxvZyhDb21wdXRlcmJvYXJkLnBsYWNlU2hpcCg2LCA1LCAzLCBcImhvcml6b250YWxcIikpO1xuY29uc3QgZ2VuZXJhdGVWaXN1YWxTaGlwcyA9ICgpID0+IHtcblxuICBjb25zdCBzaGlwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2hpcFwiKTtcbiAgLy8gbG9naWMgZm9yIGV2ZXJ5IHNoaXAsIGxvb2sgYXQgdGhlIHZpZGVvXG4gIHNoaXBzLmZvckVhY2goc2hpcCA9PiB7XG5cbiAgc2hpcC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIChlKSA9PiB7XG4gICAgZS5kYXRhVHJhbnNmZXIuc2V0RGF0YShcInNoaXBncmFiYmVkXCIsIGUudGFyZ2V0LmlkKVxuICAgIGNvbnN0IHRlbXBsZW5ndGggPSBlLnRhcmdldC5jaGlsZEVsZW1lbnRDb3VudDtcbiAgICBlLmRhdGFUcmFuc2Zlci5zZXREYXRhKFwic3RyaW5nbGVuXCIsIHRlbXBsZW5ndGgpO1xuICAgIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJ4b2ZmXCIsIGUub2Zmc2V0WCk7XG4gICAgZS5kYXRhVHJhbnNmZXIuc2V0RGF0YShcInlvZmZcIiwgZS5vZmZzZXRZKTtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidmVydGljYWxcIikpIHtcbiAgICAgIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJwb3NcIiwgXCJ2ZXJ0aWNhbFwiKTtcbiAgICB9IGVsc2UgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImhvcml6b250YWxcIikpIHtcbiAgICAgIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJwb3NcIiwgXCJob3Jpem9udGFsXCIpO1xuICAgIH1cbiAgICB9KVxuICB9KVxuXG4gIGNvbnN0IGFsbHNxdWFyZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBsYXllcnNxdWFyZVwiKTtcbiAgYWxsc3F1YXJlcy5mb3JFYWNoKHNxdWFyZSA9PiB7XG4gICAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pXG4gICAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBzdHJpbmdsZW4gPSBlLmRhdGFUcmFuc2Zlci5nZXREYXRhKFwic3RyaW5nbGVuXCIpO1xuICAgICAgY29uc3QgeG9mZiA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJ4b2ZmXCIpO1xuICAgICAgY29uc3QgeW9mZiA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJ5b2ZmXCIpO1xuICAgICAgY29uc3QgcG9zID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcInBvc1wiKTtcblxuICAgICAgY29uc3QgbGVuID0gcGFyc2VJbnQoc3RyaW5nbGVuLCAxMCk7XG4gICAgICBsZXQgb2Zmc2V0WFNxdWFyZSA9IDA7XG4gICAgICBsZXQgb2Zmc2V0WVNxdWFyZSA9IDA7XG4gICAgICBcbiAgICAgIC8vIGNvbnNvbGUubG9nKGAke2xlbn0gYW5kICR7eG9mZn0sICR7eW9mZn0gYW5kICR7cG9zfWBcblxuICAgICAgaWYgKHBvcyA9PT0gXCJ2ZXJ0aWNhbFwiKSB7XG4gICAgICAgIG9mZnNldFhTcXVhcmUgPSAwO1xuICAgICAgICBjb25zdCB0ZW1wb09mZnNldFlTcXVhcmUgPSBNYXRoLmNlaWwoeW9mZiAvIDM0KTtcbiAgICAgICAgb2Zmc2V0WVNxdWFyZSA9IGxlbiAtIHRlbXBvT2Zmc2V0WVNxdWFyZTtcbiAgICAgIH0gZWxzZSBpZiAocG9zID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgICBvZmZzZXRYU3F1YXJlID0gTWF0aC5mbG9vcih4b2ZmIC8gMzQpO1xuICAgICAgICBvZmZzZXRZU3F1YXJlID0gMDtcbiAgICAgIH0gXG4gICAgICAvLyBjb25zb2xlLmxvZyhgJHtvZmZzZXRYU3F1YXJlfSwgJHtvZmZzZXRZU3F1YXJlfWApO1xuICAgICAgXG4gICAgICBjb25zdCBzdHJpbmdjb29yZCA9IGUudGFyZ2V0LmlkO1xuICAgICAgY29uc3QgY29vcmRhcnJyYXkgPSBzdHJpbmdjb29yZC5zcGxpdChcIixcIik7XG4gICAgICAvLyBjb25zb2xlLmxvZyhjb29yZGFycnJheSk7XG5cbiAgICAgIGNvbnN0IGZpbmFseGNvb3JkID0gKHBhcnNlSW50KGNvb3JkYXJycmF5WzBdLCAxMCkpIC0gb2Zmc2V0WFNxdWFyZTtcbiAgICAgIGNvbnN0IGZpbmFseWNvb3JkID0gKHBhcnNlSW50KGNvb3JkYXJycmF5WzFdLCAxMCkpIC0gb2Zmc2V0WVNxdWFyZTtcblxuICAgICAgY29uc29sZS5sb2coYEZpbmFsIGNvb3JkcyB0byBjcmVhdGUgb2JqZWN0IGFyZTogJHtmaW5hbHhjb29yZH0sICR7ZmluYWx5Y29vcmR9YCk7XG5cbiAgICAgIC8vIHZhbGlkYXRlIG9iamVjdCBiZWZvcmUgY3JlYXRpb25cbiAgICAgIGlmIChwb3MgPT09IFwidmVydGljYWxcIiAmJiBmaW5hbHljb29yZCArIGxlbiA+IDEwIHx8IHBvcyA9PT0gXCJ2ZXJ0aWNhbFwiICYmIGZpbmFseWNvb3JkIDwgMCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcInkgYWJvdmUgMTAgb3IgYmVsb3cgMFwiKVxuICAgICAgfSBlbHNlIGlmIChwb3MgPT09IFwiaG9yaXpvbnRhbFwiICYmIGZpbmFseGNvb3JkICsgbGVuID4gMTAgfHwgcG9zID09PSBcImhvcml6b250YWxcIiAmJiBmaW5hbHhjb29yZCA8IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ4IGFib3ZlIDEwIG9yIGJlbG93IDBcIilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNyZWF0ZSBvYmplY3RcbiAgICAgICAgUGxheWVyYm9hcmQucGxhY2VTaGlwKGxlbiwgZmluYWx4Y29vcmQsIGZpbmFseWNvb3JkLCBwb3MpO1xuICAgICAgICBjb25zb2xlLmxvZyhQbGF5ZXJib2FyZC5zaGlwQXJyYXkpXG5cbiAgICAgICAgLy8gcmVtb3ZlIHRoZSBlbGVtZW50IGFmdGVyIGl0J3MgYmVlbiBwbGFjZWQuXG4gICAgICAgIGNvbnN0IHNoaXBncmFiYmVkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcInNoaXBncmFiYmVkXCIpKVxuICAgICAgICAvLyBlLmRhdGFUcmFuc2Zlci5nZXREYXRhKFwic2hpcGdyYWJiZWRcIik7XG4gICAgICAgIC8vIHNoaXBncmFiYmVkLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgc2hpcGdyYWJiZWQuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG5cbiAgICAgICAgLy8gbWFrZSBzdXJlIGFsbCB0aGUgc2hpcHMgY29vcmRzIGFyZSBoaWdobGlnaHRlZCByZWQhXG4gICAgICAgIC8vIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoXCJibHVlXCIpO1xuICAgICAgICBjb25zdCBsYXN0SW5kZXggPSBQbGF5ZXJib2FyZC5zaGlwQXJyYXkubGVuZ3RoIC0gMTtcbiAgICAgICAgY29uc3QgbGFzdFNoaXAgPSBQbGF5ZXJib2FyZC5zaGlwQXJyYXlbbGFzdEluZGV4XTtcbiAgICAgICAgYWxsc3F1YXJlcy5mb3JFYWNoKHNxdWFyID0+IHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxhc3RTaGlwLnNoaXBzQ29vcmRpbmF0ZXNBcnJheS5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaWYgKHNxdWFyLmlkID09PSBsYXN0U2hpcC5zaGlwc0Nvb3JkaW5hdGVzQXJyYXlbaV0pIHtcbiAgICAgICAgICAgICAgc3F1YXIuY2xhc3NMaXN0LmFkZChcImJsdWVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH0pXG5cbn1cblxuZ2VuZXJhdGVWaXN1YWxTaGlwcygpO1xuXG4iXSwibmFtZXMiOlsiR2FtZWJvYXJkIiwiYXJlQWxsU2hpcHNTdW5rIiwiU3F1YXJlc0hpdCIsInNoaXBBcnJheSIsInBsYWNlU2hpcCIsImxlbmd0aCIsInhjb29yZCIsInljb29yZCIsInBvc2l0aW9uIiwibmV3U2hpcCIsInRlbXB4IiwidGVtcHkiLCJzaGlwc0Nvb3JkaW5hdGVzQXJyYXkiLCJpIiwic2hpcENvb3JkaW5hdGVzIiwicHVzaCIsImhpdHMiLCJoaXQiLCJpc1N1bmsiLCJsZW5ndGhPZlNoaXAiLCJoaXRzT2ZTaGlwIiwic3Vua1N0YXR1cyIsIlNoaXAiLCJyZWNlaXZlQXR0YWNrIiwid2FzSGl0IiwibWVzc2FnZSIsImNvb3JkaW5hdGVzIiwiaW5jbHVkZXMiLCJmb3JFYWNoIiwic2hpcCIsInNlbGVjdGVkU2hpcENvb3JkaW5hdGVzIiwiZGV0ZXJtaW5lSWZDb25jbHVkZWQiLCJzdW5rZW5TaGlwcyIsIlBsYXllciIsInBsYXllcm5hbWUiLCJ0dXJuIiwicGxheWVyYm9hcmRkaXYiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwbGF5ZXJCb2FyZCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsInJvdyIsImoiLCJzcXVhcmVsYWJlbCIsInRleHRDb250ZW50Iiwic3F1YXJlIiwic2V0QXR0cmlidXRlIiwiZ2VuZXJhdGVQbGF5ZXJCb2FyZCIsIlBsYXllcmJvYXJkIiwiY29tcHV0ZXJib2FyZGRpdiIsImdlbmVyYXRlQ29tcHV0ZXJCb2FyZCIsIkNvbXB1dGVyYm9hcmQiLCJ0ZW1weGNvb3JkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidGVtcHljb29yZCIsInRlbXBwb3MiLCJ0ZW1wcG9zaXRpb24iLCJjb25zb2xlIiwibG9nIiwicXVlcnlTZWxlY3RvckFsbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsInRhcmdldCIsImlkIiwidGVtcGxlbmd0aCIsImNoaWxkRWxlbWVudENvdW50Iiwib2Zmc2V0WCIsIm9mZnNldFkiLCJjb250YWlucyIsImFsbHNxdWFyZXMiLCJwcmV2ZW50RGVmYXVsdCIsInN0cmluZ2xlbiIsImdldERhdGEiLCJ4b2ZmIiwieW9mZiIsInBvcyIsImxlbiIsInBhcnNlSW50Iiwib2Zmc2V0WFNxdWFyZSIsIm9mZnNldFlTcXVhcmUiLCJjZWlsIiwiY29vcmRhcnJyYXkiLCJzcGxpdCIsImZpbmFseGNvb3JkIiwiZmluYWx5Y29vcmQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwidmlzaWJpbGl0eSIsImxhc3RJbmRleCIsImxhc3RTaGlwIiwic3F1YXIiLCJnZW5lcmF0ZVZpc3VhbFNoaXBzIl0sInNvdXJjZVJvb3QiOiIifQ==